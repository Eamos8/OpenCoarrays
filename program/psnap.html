<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="OpenCoarrays is a Coarray Fortran (CAF) implementation supporting Fortran 2008 and 2015 features">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>psnap &ndash; OpenCoarrays</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">OpenCoarrays <small>master</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>psnap 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/cafpsnap.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/cafpsnap.f90.html'>cafpsnap.f90</a></li>
  
     <li class="active">psnap</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../program/psnap.html#variable-astat">astat</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-barrier%7E2">barrier</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-cl_arg">cl_arg</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-count_loc">count_loc</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-globalmax">globalmax</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-globalmaxloc">globalmaxloc</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-globalminloc">globalminloc</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-granularity">granularity</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-i%7E56">i</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-iteration_count">iteration_count</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-j%7E17">j</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-localhist">localhist</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-localmax">localmax</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-localsum">localsum</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-n%7E5">n</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-np">np</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-np_half">np_half</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-psnap_rcs_id">psnap_rcs_id</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-r%7E2">r</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-rank">rank</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-string_fmt">string_fmt</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-sum_all">sum_all</a>
        
        <a class="list-group-item" href="../program/psnap.html#variable-w">w</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters">Interfaces</a></h3></div>
    <div id="inters" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/psnap.html#interface-elapsed_time">elapsed_time</a>
          
          <a class="list-group-item" href="../program/psnap.html#interface-start_timer">start_timer</a>
          
          <a class="list-group-item" href="../program/psnap.html#interface-stop_timer">stop_timer</a>
          
        </div>
    </div>
  </div>
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#types">Derived Types</a></h3></div>
    <div id="types" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../program/psnap.html#type-counters">counters</a>
        
      </div>
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#funcs">Functions</a></h3></div>
    <div id="funcs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/psnap.html#proc-calibrate_loop">calibrate_loop</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-from_lower_half">from_lower_half</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-get_usecs">get_usecs</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-loop">loop</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-sending_half">sending_half</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-to_upper_half">to_upper_half</a>
          
        </div>
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs">Subroutines</a></h3></div>
    <div class="list-group">
        <div id="subs" class="panel-collapse collapse">
          
          <a class="list-group-item" href="../program/psnap.html#proc-print_banner">print_banner</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-usage">usage</a>
          
          <a class="list-group-item" href="../program/psnap.html#proc-warmup_loop">warmup_loop</a>
          
        </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../program/psnap.html#src">psnap</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs">All Programs</a></h3></div>
    <div id="allprogs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/alloc_as_barrier.html">alloc_as_barrier</a>
          
          <a class="list-group-item" href="../program/alloc_as_barrier%7E2.html">alloc_as_barrier</a>
          
          <a class="list-group-item" href="../program/atomic.html">atomic</a>
          
          <a class="list-group-item" href="../program/coarray_distributed_transpose.html">coarray_distributed_transpose</a>
          
          <a class="list-group-item" href="../program/cshear.html">cshear</a>
          
          <a class="list-group-item" href="../program/cshear%7E2.html">cshear</a>
          
          <a class="list-group-item" href="../program/cshear%7E3.html">cshear</a>
          
          <a class="list-group-item" href="../program/duplicate_syncimages.html">duplicate_syncimages</a>
          
          <a class="list-group-item" href="../program/get_offset_1d.html">get_offset_1d</a>
          
          <a class="list-group-item" href="../program/hello_multiverse.html">hello_multiverse</a>
          
          <a class="list-group-item" href="../program/initialize_mpi.html">initialize_mpi</a>
          
          <a class="list-group-item" href="../program/main.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E2.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E3.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E4.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E5.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E6.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E7.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E8.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E9.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E10.html">main</a>
          
          <a class="list-group-item" href="../program/main%7E11.html">main</a>
          
          <a class="list-group-item" href="../program/mpi_distributed_transpose.html">mpi_distributed_transpose</a>
          
          <a class="list-group-item" href="../program/mshear.html">mshear</a>
          
          <a class="list-group-item" href="../program/psnap.html">psnap</a>
          
          <a class="list-group-item" href="../program/register.html">register</a>
          
          <a class="list-group-item" href="../program/register2.html">register2</a>
          
          <a class="list-group-item" href="../program/register3.html">register3</a>
          
          <a class="list-group-item" href="../program/sameloc.html">sameloc</a>
          
          <a class="list-group-item" href="../program/strided_get.html">strided_get</a>
          
          <a class="list-group-item" href="../program/sync_images_stat.html">sync_images_stat</a>
          
          <a class="list-group-item" href="../program/syncall.html">syncall</a>
          
          <a class="list-group-item" href="../program/syncimages.html">syncimages</a>
          
          <a class="list-group-item" href="../program/syncimages%7E2.html">syncimages</a>
          
          <a class="list-group-item" href="../program/syncimages2.html">syncimages2</a>
          
          <a class="list-group-item" href="../program/syncimages2%7E2.html">syncimages2</a>
          
          <a class="list-group-item" href="../program/test1caf.html">test1caf</a>
          
          <a class="list-group-item" href="../program/whole_array_get.html">whole_array_get</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li><a href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html">iso_fortran_env</a></li>
      
      <li><a href="https://software.intel.com/en-us/node/511038">iso_c_binding</a></li>
      
    </ul>
  

    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: program~~psnap~~UsesGraph Pages: 1 -->
<svg id="programpsnapUsesGraph" width="183pt" height="74pt"
 viewBox="0.00 0.00 183.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~psnap~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>program~~psnap~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 179,-70 179,4 -4,4"/>
<!-- program~psnap -->
<g id="program~~psnap~~UsesGraph_node1" class="node"><title>program~psnap</title>
<polygon fill="none" stroke="black" points="175,-45 121,-45 121,-21 175,-21 175,-45"/>
<text text-anchor="middle" x="148" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">psnap</text>
</g>
<!-- iso_c_binding -->
<g id="program~~psnap~~UsesGraph_node2" class="node"><title>iso_c_binding</title>
<g id="a_program~~psnap~~UsesGraph_node2"><a xlink:href="https://software.intel.com/en-us/node/511038" xlink:title="iso_c_binding">
<polygon fill="#337ab7" stroke="#337ab7" points="81,-66 4,-66 4,-42 81,-42 81,-66"/>
<text text-anchor="middle" x="42.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_c_binding</text>
</a>
</g>
</g>
<!-- iso_c_binding&#45;&gt;program~psnap -->
<g id="program~~psnap~~UsesGraph_edge1" class="edge"><title>iso_c_binding&#45;&gt;program~psnap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M81.1587,-46.3591C90.8364,-44.3955 101.226,-42.2875 110.827,-40.3395"/>
<polygon fill="#000000" stroke="#000000" points="111.759,-43.7217 120.864,-38.303 110.367,-36.8614 111.759,-43.7217"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~psnap~~UsesGraph_node3" class="node"><title>iso_fortran_env</title>
<g id="a_program~~psnap~~UsesGraph_node3"><a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="85,-24 0,-24 0,-0 85,-0 85,-24"/>
<text text-anchor="middle" x="42.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- iso_fortran_env&#45;&gt;program~psnap -->
<g id="program~~psnap~~UsesGraph_edge2" class="edge"><title>iso_fortran_env&#45;&gt;program~psnap</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.001,-20.4205C93.6373,-22.1728 102.67,-24.0056 111.085,-25.7129"/>
<polygon fill="#000000" stroke="#000000" points="110.478,-29.161 120.974,-27.7195 111.87,-22.3008 110.478,-29.161"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="26pt"
 viewBox="0.00 0.00 641.00 26.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.819693 0.819693) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 778,-28 778,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-24 72,-24 72,-0 138,-0 138,-24"/>
<text text-anchor="middle" x="105" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-24 156,-24 156,-0 210,-0 210,-24"/>
<text text-anchor="middle" x="183" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="291.5,-24 228.5,-24 228.5,-0 291.5,-0 291.5,-24"/>
<text text-anchor="middle" x="260" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="588,-24 454,-24 454,-0 588,-0 588,-24"/>
<text text-anchor="middle" x="521" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="660,-24 606,-24 606,-0 660,-0 660,-24"/>
<text text-anchor="middle" x="633" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="774,-24 678,-24 678,-0 774,-0 774,-24"/>
<text text-anchor="middle" x="726" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    <br><br>
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: program~~psnap~~CallsGraph Pages: 1 -->
<svg id="programpsnapCallsGraph" width="389pt" height="284pt"
 viewBox="0.00 0.00 389.00 284.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~psnap~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 280)">
<title>program~~psnap~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-280 385,-280 385,4 -4,4"/>
<!-- program~psnap -->
<g id="program~~psnap~~CallsGraph_node1" class="node"><title>program~psnap</title>
<polygon fill="none" stroke="black" points="54,-172 0,-172 0,-148 54,-148 54,-172"/>
<text text-anchor="middle" x="27" y="-157.6" font-family="Helvetica,sans-Serif" font-size="10.50">psnap</text>
</g>
<!-- images -->
<g id="program~~psnap~~CallsGraph_node2" class="node"><title>images</title>
<polygon fill="#777777" stroke="#777777" points="364.5,-276 310.5,-276 310.5,-252 364.5,-252 364.5,-276"/>
<text text-anchor="middle" x="337.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">images</text>
</g>
<!-- program~psnap&#45;&gt;images -->
<g id="program~~psnap~~CallsGraph_edge10" class="edge"><title>program~psnap&#45;&gt;images</title>
<path fill="none" stroke="#000000" d="M33.3314,-172.176C42.1448,-190.663 61.6417,-225.313 90,-241 156.89,-278.001 249.811,-274.692 300.31,-269.223"/>
<polygon fill="#000000" stroke="#000000" points="300.894,-272.679 310.418,-268.037 300.078,-265.726 300.894,-272.679"/>
</g>
<!-- proc~print_banner -->
<g id="program~~psnap~~CallsGraph_node3" class="node"><title>proc~print_banner</title>
<g id="a_program~~psnap~~CallsGraph_node3"><a xlink:href="../proc/print_banner.html" xlink:title="print_banner">
<polygon fill="#d9534f" stroke="#d9534f" points="164.5,-232 93.5,-232 93.5,-208 164.5,-208 164.5,-232"/>
<text text-anchor="middle" x="129" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_banner</text>
</a>
</g>
</g>
<!-- program~psnap&#45;&gt;proc~print_banner -->
<g id="program~~psnap~~CallsGraph_edge11" class="edge"><title>program~psnap&#45;&gt;proc~print_banner</title>
<path fill="none" stroke="#000000" d="M48.2365,-172.142C62.8752,-180.925 82.8654,-192.919 99.1713,-202.703"/>
<polygon fill="#000000" stroke="#000000" points="97.4179,-205.732 107.794,-207.876 101.019,-199.73 97.4179,-205.732"/>
</g>
<!-- proc~loop -->
<g id="program~~psnap~~CallsGraph_node4" class="node"><title>proc~loop</title>
<g id="a_program~~psnap~~CallsGraph_node4"><a xlink:href="../proc/loop.html" xlink:title="loop">
<polygon fill="#d94e8f" stroke="#d94e8f" points="258,-151 204,-151 204,-127 258,-127 258,-151"/>
<text text-anchor="middle" x="231" y="-136.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">loop</text>
</a>
</g>
</g>
<!-- program~psnap&#45;&gt;proc~loop -->
<g id="program~~psnap~~CallsGraph_edge12" class="edge"><title>program~psnap&#45;&gt;proc~loop</title>
<path fill="none" stroke="#000000" d="M54.0267,-162.915C82.3084,-165.451 128.716,-167.763 168,-161 176.737,-159.496 185.877,-156.881 194.37,-153.967"/>
<polygon fill="#000000" stroke="#000000" points="195.789,-157.176 203.982,-150.459 193.389,-150.6 195.789,-157.176"/>
</g>
<!-- proc~warmup_loop -->
<g id="program~~psnap~~CallsGraph_node5" class="node"><title>proc~warmup_loop</title>
<g id="a_program~~psnap~~CallsGraph_node5"><a xlink:href="../proc/warmup_loop.html" xlink:title="warmup_loop">
<polygon fill="#d9534f" stroke="#d9534f" points="167,-152 91,-152 91,-128 167,-128 167,-152"/>
<text text-anchor="middle" x="129" y="-137.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">warmup_loop</text>
</a>
</g>
</g>
<!-- program~psnap&#45;&gt;proc~warmup_loop -->
<g id="program~~psnap~~CallsGraph_edge13" class="edge"><title>program~psnap&#45;&gt;proc~warmup_loop</title>
<path fill="none" stroke="#000000" d="M54.0128,-154.797C62.2575,-153.149 71.6425,-151.271 80.895,-149.421"/>
<polygon fill="#000000" stroke="#000000" points="81.7032,-152.829 90.8225,-147.435 80.3303,-145.965 81.7032,-152.829"/>
</g>
<!-- proc~usage -->
<g id="program~~psnap~~CallsGraph_node6" class="node"><title>proc~usage</title>
<g id="a_program~~psnap~~CallsGraph_node6"><a xlink:href="../proc/usage.html" xlink:title="usage">
<polygon fill="#d9534f" stroke="#d9534f" points="156,-110 102,-110 102,-86 156,-86 156,-110"/>
<text text-anchor="middle" x="129" y="-95.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">usage</text>
</a>
</g>
</g>
<!-- program~psnap&#45;&gt;proc~usage -->
<g id="program~~psnap~~CallsGraph_edge14" class="edge"><title>program~psnap&#45;&gt;proc~usage</title>
<path fill="none" stroke="#000000" d="M45.3995,-147.959C57.6972,-139.581 74.6572,-128.292 90,-119 92.1437,-117.702 94.3716,-116.386 96.6257,-115.08"/>
<polygon fill="#000000" stroke="#000000" points="98.355,-118.123 105.326,-110.145 94.9012,-112.035 98.355,-118.123"/>
</g>
<!-- proc~calibrate_loop -->
<g id="program~~psnap~~CallsGraph_node7" class="node"><title>proc~calibrate_loop</title>
<g id="a_program~~psnap~~CallsGraph_node7"><a xlink:href="../proc/calibrate_loop.html" xlink:title="calibrate_loop">
<polygon fill="#d94e8f" stroke="#d94e8f" points="168,-68 90,-68 90,-44 168,-44 168,-68"/>
<text text-anchor="middle" x="129" y="-53.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calibrate_loop</text>
</a>
</g>
</g>
<!-- program~psnap&#45;&gt;proc~calibrate_loop -->
<g id="program~~psnap~~CallsGraph_edge15" class="edge"><title>program~psnap&#45;&gt;proc~calibrate_loop</title>
<path fill="none" stroke="#000000" d="M34.8668,-147.733C45.0895,-130.307 65.7328,-98.1574 90,-77 91.289,-75.8762 92.648,-74.7866 94.0544,-73.7341"/>
<polygon fill="#000000" stroke="#000000" points="96.0876,-76.5853 102.472,-68.1298 92.208,-70.7586 96.0876,-76.5853"/>
</g>
<!-- proc~loop&#45;&gt;images -->
<g id="program~~psnap~~CallsGraph_edge6" class="edge"><title>proc~loop&#45;&gt;images</title>
<path fill="none" stroke="#000000" d="M236.522,-151.101C244.935,-172.199 264.825,-216.034 294,-243 296.283,-245.111 298.819,-247.056 301.481,-248.838"/>
<polygon fill="#000000" stroke="#000000" points="299.871,-251.951 310.27,-253.98 303.406,-245.909 299.871,-251.951"/>
</g>
<!-- interface~elapsed_time -->
<g id="program~~psnap~~CallsGraph_node8" class="node"><title>interface~elapsed_time</title>
<g id="a_program~~psnap~~CallsGraph_node8"><a xlink:href="../interface/elapsed_time.html" xlink:title="elapsed_time">
<polygon fill="#a7506f" stroke="#a7506f" points="375,-234 300,-234 300,-210 375,-210 375,-234"/>
<text text-anchor="middle" x="337.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elapsed_time</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;interface~elapsed_time -->
<g id="program~~psnap~~CallsGraph_edge1" class="edge"><title>proc~loop&#45;&gt;interface~elapsed_time</title>
<path fill="none" stroke="#000000" d="M241.987,-151.14C253.493,-164.576 273.466,-186.273 294,-201 295.848,-202.325 297.791,-203.609 299.789,-204.844"/>
<polygon fill="#000000" stroke="#000000" points="298.336,-208.044 308.761,-209.935 301.791,-201.956 298.336,-208.044"/>
</g>
<!-- proc~from_lower_half -->
<g id="program~~psnap~~CallsGraph_node9" class="node"><title>proc~from_lower_half</title>
<g id="a_program~~psnap~~CallsGraph_node9"><a xlink:href="../proc/from_lower_half.html" xlink:title="from_lower_half">
<polygon fill="#d94e8f" stroke="#d94e8f" points="381,-192 294,-192 294,-168 381,-168 381,-192"/>
<text text-anchor="middle" x="337.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">from_lower_half</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;proc~from_lower_half -->
<g id="program~~psnap~~CallsGraph_edge2" class="edge"><title>proc~loop&#45;&gt;proc~from_lower_half</title>
<path fill="none" stroke="#000000" d="M258.1,-149.24C269.662,-153.776 283.525,-159.216 296.357,-164.25"/>
<polygon fill="#000000" stroke="#000000" points="295.327,-167.606 305.914,-168 297.883,-161.089 295.327,-167.606"/>
</g>
<!-- interface~stop_timer -->
<g id="program~~psnap~~CallsGraph_node10" class="node"><title>interface~stop_timer</title>
<g id="a_program~~psnap~~CallsGraph_node10"><a xlink:href="../interface/stop_timer.html" xlink:title="stop_timer">
<polygon fill="#a7506f" stroke="#a7506f" points="368.5,-150 306.5,-150 306.5,-126 368.5,-126 368.5,-150"/>
<text text-anchor="middle" x="337.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stop_timer</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;interface~stop_timer -->
<g id="program~~psnap~~CallsGraph_edge3" class="edge"><title>proc~loop&#45;&gt;interface~stop_timer</title>
<path fill="none" stroke="#000000" d="M258.1,-138.75C269.53,-138.641 283.208,-138.51 295.917,-138.388"/>
<polygon fill="#000000" stroke="#000000" points="296.327,-141.885 306.293,-138.289 296.26,-134.885 296.327,-141.885"/>
</g>
<!-- proc~sending_half -->
<g id="program~~psnap~~CallsGraph_node11" class="node"><title>proc~sending_half</title>
<g id="a_program~~psnap~~CallsGraph_node11"><a xlink:href="../proc/sending_half.html" xlink:title="sending_half">
<polygon fill="#d94e8f" stroke="#d94e8f" points="373.5,-108 301.5,-108 301.5,-84 373.5,-84 373.5,-108"/>
<text text-anchor="middle" x="337.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sending_half</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;proc~sending_half -->
<g id="program~~psnap~~CallsGraph_edge4" class="edge"><title>proc~loop&#45;&gt;proc~sending_half</title>
<path fill="none" stroke="#000000" d="M258.1,-128.26C270.067,-123.336 284.5,-117.397 297.703,-111.964"/>
<polygon fill="#000000" stroke="#000000" points="299.131,-115.162 307.046,-108.12 296.467,-108.688 299.131,-115.162"/>
</g>
<!-- interface~start_timer -->
<g id="program~~psnap~~CallsGraph_node12" class="node"><title>interface~start_timer</title>
<g id="a_program~~psnap~~CallsGraph_node12"><a xlink:href="../interface/start_timer.html" xlink:title="start_timer">
<polygon fill="#a7506f" stroke="#a7506f" points="368.5,-66 306.5,-66 306.5,-42 368.5,-42 368.5,-66"/>
<text text-anchor="middle" x="337.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;interface~start_timer -->
<g id="program~~psnap~~CallsGraph_edge5" class="edge"><title>proc~loop&#45;&gt;interface~start_timer</title>
<path fill="none" stroke="#000000" d="M241.498,-126.94C252.862,-113.091 273.001,-90.3137 294,-75 295.837,-73.6604 297.772,-72.3653 299.764,-71.1208"/>
<polygon fill="#000000" stroke="#000000" points="301.771,-74.0052 308.719,-66.0069 298.299,-67.9266 301.771,-74.0052"/>
</g>
<!-- proc~to_upper_half -->
<g id="program~~psnap~~CallsGraph_node13" class="node"><title>proc~to_upper_half</title>
<g id="a_program~~psnap~~CallsGraph_node13"><a xlink:href="../proc/to_upper_half.html" xlink:title="to_upper_half">
<polygon fill="#d94e8f" stroke="#d94e8f" points="376,-24 299,-24 299,-0 376,-0 376,-24"/>
<text text-anchor="middle" x="337.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">to_upper_half</text>
</a>
</g>
</g>
<!-- proc~loop&#45;&gt;proc~to_upper_half -->
<g id="program~~psnap~~CallsGraph_edge7" class="edge"><title>proc~loop&#45;&gt;proc~to_upper_half</title>
<path fill="none" stroke="#000000" d="M236.46,-126.664C244.777,-105.157 264.524,-60.473 294,-33 295.129,-31.9479 296.32,-30.9372 297.559,-29.9676"/>
<polygon fill="#000000" stroke="#000000" points="299.887,-32.6218 306.262,-24.1593 296.001,-26.7995 299.887,-32.6218"/>
</g>
<!-- proc~warmup_loop&#45;&gt;proc~loop -->
<g id="program~~psnap~~CallsGraph_edge8" class="edge"><title>proc~warmup_loop&#45;&gt;proc~loop</title>
<path fill="none" stroke="#000000" d="M167.236,-139.628C175.922,-139.541 185.157,-139.448 193.797,-139.362"/>
<polygon fill="#000000" stroke="#000000" points="193.998,-142.86 203.963,-139.26 193.928,-135.861 193.998,-142.86"/>
</g>
<!-- proc~calibrate_loop&#45;&gt;proc~loop -->
<g id="program~~psnap~~CallsGraph_edge9" class="edge"><title>proc~calibrate_loop&#45;&gt;proc~loop</title>
<path fill="none" stroke="#000000" d="M154.354,-68.1238C159.033,-70.8196 163.784,-73.8273 168,-77 184.519,-89.4313 200.961,-106.122 212.758,-119.055"/>
<polygon fill="#000000" stroke="#000000" points="210.186,-121.43 219.462,-126.549 215.403,-116.763 210.186,-121.43"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="26pt"
 viewBox="0.00 0.00 641.00 26.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.819693 0.819693) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 778,-28 778,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-24 72,-24 72,-0 138,-0 138,-24"/>
<text text-anchor="middle" x="105" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-24 156,-24 156,-0 210,-0 210,-24"/>
<text text-anchor="middle" x="183" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="291.5,-24 228.5,-24 228.5,-0 291.5,-0 291.5,-24"/>
<text text-anchor="middle" x="260" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="588,-24 454,-24 454,-0 588,-0 588,-24"/>
<text text-anchor="middle" x="521" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="660,-24 606,-24 606,-0 660,-0 660,-24"/>
<text text-anchor="middle" x="633" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="774,-24 678,-24 678,-0 774,-0 774,-24"/>
<text text-anchor="middle" x="726" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

Where possible, edges connecting nodes are given different colours to make them
easier to distinguish in large graphs.
<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-astat"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>astat</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-barrier%7E2"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *], save</td><td>::</td>
  <td><strong>barrier</strong></td><td> =</td><td>0</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cl_arg"></span>character(len=32)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cl_arg</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-count_loc"></span>type(<a href='../type/counters.html'>counters</a>),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>count_loc</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-globalmax"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>globalmax</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-globalmaxloc"></span>type(<a href='../type/counters.html'>counters</a>),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>globalmaxloc</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-globalminloc"></span>type(<a href='../type/counters.html'>counters</a>),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>globalminloc</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-granularity"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *], save</td><td>::</td>
  <td><strong>granularity</strong></td><td> =</td><td>1000</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i%7E56"></span>integer(kind=int64)</td>
  
  
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iteration_count"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *], save</td><td>::</td>
  <td><strong>iteration_count</strong></td><td> =</td><td>0</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-j%7E17"></span>integer(kind=int64)</td>
  
  
  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-localhist"></span>integer(kind=int64),</td>
  
  
  <td>dimension( :), allocatable, codimension[ :]</td><td>::</td>
  <td><strong>localhist</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-localmax"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>localmax</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-localsum"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *]</td><td>::</td>
  <td><strong>localsum</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n%7E5"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *], save</td><td>::</td>
  <td><strong>n</strong></td><td> =</td><td>1000</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-np"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>np</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-np_half"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>np_half</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-psnap_rcs_id"></span>character(len=*),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>psnap_rcs_id</strong></td><td> =</td><td>'$Id$'</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-r%7E2"></span>integer(kind=int64),</td>
  
  
  <td>dimension( :), allocatable</td><td>::</td>
  <td><strong>r</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rank"></span>integer</td>
  
  
  <td></td><td>::</td>
  <td><strong>rank</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-string_fmt"></span>character(len=*),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>string_fmt</strong></td><td> =</td><td>'( a)'</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sum_all"></span>integer(kind=int64),</td>
  
  
  <td>dimension( :), allocatable</td><td>::</td>
  <td><strong>sum_all</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-w"></span>integer(kind=int64),</td>
  
  
  <td>codimension[ *], save</td><td>::</td>
  <td><strong>w</strong></td><td> =</td><td>1000</td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    <section>
	 <h2>Interfaces</h2>
	 
	   
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-elapsed_time"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
function <a href='../interface/elapsed_time.html'>elapsed_time</a>() result(res) bind(c,name="elapsed_time")
    
    
    
</h3>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  
  
  
  
     <h4>Return Value <small>integer(kind=c_int)
  </small></h4>
  
    
        

    </li>
  
  </ul>
</div>

    
	   
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-start_timer"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
subroutine <a href='../interface/start_timer.html'>start_timer</a>() bind(C, name="0")
    
    
    
</h3>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
        

    </li>
  
  </ul>
</div>

    
	   
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-stop_timer"></span><h3>interface 
    
  </h3></div>
  
  <ul class="list-group">
  
    <li class="list-group-item">
    
    
    <h3>
subroutine <a href='../interface/stop_timer.html'>stop_timer</a>() bind(C, name="0")
    
    
    
</h3>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
        

    </li>
  
  </ul>
</div>

    
    </section>
	 <br>
    
    
    

    
    <section>
	 <h2>Derived Types</h2>
	 
	   
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="type-counters"></span><h3>type, bind( c) :: <a href='../type/counters.html'>counters</a>
    
  </h3></div>
  <div class="panel-body">
     
     <h4>Components</h4>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-index"></span>integer(kind=c_int),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>index</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-val"></span>integer(kind=c_long),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>val</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

     
     
          
     
     
  </div>
</div>

    
    </section>
	 <br>
    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-calibrate_loop"></span><h3>
function <a href='../proc/calibrate_loop.html'>calibrate_loop</a>(usecs) result(cl)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=int64),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>usecs</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer(kind=int64)
  </small></h4>
  
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-from_lower_half"></span><h3>
function <a href='../proc/from_lower_half.html'>from_lower_half</a>(i) result(l)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_usecs"></span><h3>
function <a href='../proc/get_usecs.html'>get_usecs</a>() result(usecs)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=real64)
  </small></h4>
  
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-loop"></span><h3>
function <a href='../proc/loop.html'>loop</a>(iterations) result(dt)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=int64),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer(kind=int64)
  </small></h4>
  
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-sending_half"></span><h3>
function <a href='../proc/sending_half.html'>sending_half</a>(i) result(l)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>logical
  </small></h4>
  
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-to_upper_half"></span><h3>
function <a href='../proc/to_upper_half.html'>to_upper_half</a>(i) result(l)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  
    
        

  </div>
  </div>

    
    </section>
    <br>
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-print_banner"></span><h3>
subroutine <a href='../proc/print_banner.html'>print_banner</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-usage"></span><h3>
subroutine <a href='../proc/usage.html'>usage</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-warmup_loop"></span><h3>
subroutine <a href='../proc/warmup_loop.html'>warmup_loop</a>(wa)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=int64),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>wa</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    
        

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">psnap</span>

<span class="c">!  #define VERSION_STR &quot;v1.2&quot;</span>

<span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">error_unit</span><span class="p">,</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">real64</span><span class="p">,</span> <span class="n">int32</span>

<span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="nb">iso_c_binding</span>

<span class="kt">character</span><span class="p">(</span> <span class="nb">len</span><span class="o">=</span> <span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">psnap_rcs_id</span> <span class="o">=</span> <span class="p">&amp;</span>
   <span class="s1">&#39;$Id$&#39;</span>

<span class="kt">character</span><span class="p">(</span> <span class="nb">len</span><span class="o">=</span> <span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">string_fmt</span> <span class="o">=</span> <span class="s1">&#39;( a)&#39;</span>

<span class="k">type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span> <span class="n">c</span><span class="p">)</span> <span class="kd">::</span> <span class="n">counters</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="kt">c_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="kt">c_int</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">index</span>

<span class="k">end type </span><span class="n">counters</span>

<span class="c">!  int rank, np; // globals</span>

<span class="kt">integer</span> <span class="kd">::</span> <span class="n">rank</span>
<span class="kt">integer</span> <span class="kd">::</span> <span class="n">np</span>
<span class="kt">integer</span> <span class="kd">::</span> <span class="n">np_half</span>

<span class="c">!integer( int64), save :: n = 100000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span> <span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">r</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">]</span> <span class="kd">::</span> <span class="n">localmax</span><span class="p">,</span> <span class="n">globalmax</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">]</span> <span class="kd">::</span> <span class="n">localsum</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span> <span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sum_all</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span> <span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">codimension</span><span class="p">[</span> <span class="p">:]</span> <span class="kd">::</span> <span class="n">localhist</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">granularity</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">barrier</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c">!character( kind= c_char, len= 1024), codimension[ *] :: hostname</span>

<span class="k">interface</span>
<span class="k">  subroutine </span><span class="n">start_timer</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;start_timer&quot;</span><span class="p">)</span>
    <span class="k">use </span><span class="nb">iso_c_binding</span>
<span class="nb">  </span><span class="k">end subroutine</span>
<span class="k">  subroutine </span><span class="n">stop_timer</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stop_timer&quot;</span><span class="p">)</span>
    <span class="k">use </span><span class="nb">iso_c_binding</span>
<span class="nb">  </span><span class="k">end subroutine</span>
<span class="k">  function </span><span class="n">elapsed_time</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;elapsed_time&quot;</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">use </span><span class="nb">iso_c_binding</span>
    <span class="c">!use, intrinsic :: iso_fortran_env, only: int64</span>
    <span class="kt">integer</span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
  <span class="k">end function</span>
<span class="k">end interface</span>

<span class="k">type</span><span class="p">(</span> <span class="n">counters</span><span class="p">),</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">]</span> <span class="kd">::</span> <span class="n">count_loc</span><span class="p">,</span> <span class="n">globalminloc</span><span class="p">,</span> <span class="n">globalmaxloc</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">j</span>
   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">astat</span>

   <span class="kt">character</span><span class="p">(</span> <span class="nb">len</span><span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cl_arg</span>

<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!  psnap text</span>

<span class="k">continue</span>

<span class="k">   </span><span class="n">rank</span> <span class="o">=</span> <span class="nb">this_image</span><span class="p">()</span>
   <span class="n">np</span> <span class="o">=</span> <span class="nb">num_images</span><span class="p">()</span>
   <span class="n">np_half</span> <span class="o">=</span> <span class="n">np</span> <span class="o">/</span> <span class="mi">2</span>

   <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      </span><span class="n">cl_args</span><span class="p">:</span> <span class="k">do</span>

<span class="k">         </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>

         <span class="k">if</span><span class="p">(</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="nb">command_argument_count</span><span class="p">()</span> <span class="p">)</span> <span class="k">exit </span><span class="n">cl_args</span>

         <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>

         <span class="n">which_arg</span><span class="p">:</span> <span class="k">select case</span><span class="p">(</span> <span class="n">cl_arg</span><span class="p">(</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">))</span>

         <span class="k">case</span><span class="p">(</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>
            <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">barrier</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="o">*</span><span class="p">)</span> <span class="n">cl_arg</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
               <span class="n">barrier</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">barrier</span>
            <span class="k">end do</span>

<span class="k">         case</span><span class="p">(</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>
            <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="o">*</span><span class="p">)</span> <span class="n">cl_arg</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">10</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
               <span class="n">n</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
               <span class="n">w</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span>
            <span class="k">end do</span>

<span class="k">         case</span><span class="p">(</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>
            <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="o">*</span><span class="p">)</span> <span class="n">cl_arg</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
               <span class="n">w</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span>
            <span class="k">end do</span>

<span class="k">         case</span><span class="p">(</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>
            <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">iteration_count</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="o">*</span><span class="p">)</span> <span class="n">cl_arg</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
               <span class="n">iteration_count</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">iteration_count</span>
            <span class="k">end do</span>

<span class="k">         case</span><span class="p">(</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span> <span class="n">number</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">int32</span><span class="p">),</span> <span class="k">value</span><span class="o">=</span> <span class="n">cl_arg</span><span class="p">)</span>
            <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">granularity</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="o">*</span><span class="p">)</span> <span class="n">cl_arg</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
               <span class="n">granularity</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">granularity</span>
            <span class="k">end do</span>

<span class="k">         case</span><span class="p">(</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span>

            <span class="k">call </span><span class="n">usage</span><span class="p">()</span>
            <span class="k">stop</span> <span class="s1">&#39;normal exit in psnap&#39;</span>

         <span class="k">case </span><span class="n">default</span>

            <span class="k">call </span><span class="n">usage</span><span class="p">()</span>
            <span class="k">stop</span> <span class="s1">&#39;normal exit in psnap&#39;</span>

         <span class="k">end select </span><span class="n">which_arg</span>

      <span class="k">end do </span><span class="n">cl_args</span>

   <span class="k">end if</span>

<span class="c">!  distribute sizes before allocating</span>

   <span class="k">sync all</span>

   <span class="c">!call get_environment_variable( name= &#39;HOSTNAME&#39;, value= hostname)</span>

   <span class="k">allocate</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span> <span class="n">n</span> <span class="o">+</span> <span class="n">w</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span> <span class="n">astat</span><span class="p">)</span>

   <span class="n">alloc_r_error</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">astat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      stop</span> <span class="s1">&#39;error allocating r&#39;</span>

   <span class="k">end if </span><span class="n">alloc_r_error</span>

   <span class="k">allocate</span><span class="p">(</span> <span class="n">sum_all</span><span class="p">(</span> <span class="mi">1</span><span class="p">:</span> <span class="n">np</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span> <span class="n">astat</span><span class="p">)</span>

   <span class="n">alloc_sum_error</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">astat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      stop</span> <span class="s1">&#39;error allocating sum_all&#39;</span>

   <span class="k">end if </span><span class="n">alloc_sum_error</span>

   <span class="n">only_rank_0</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      call </span><span class="n">print_banner</span><span class="p">()</span>

   <span class="k">end if </span><span class="n">only_rank_0</span>

<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!  warmup loop here; calibration follows</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">call </span><span class="n">warmup_loop</span><span class="p">(</span> <span class="n">w</span><span class="p">)</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">iteration_count</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      </span><span class="n">iteration_count</span> <span class="o">=</span> <span class="n">calibrate_loop</span><span class="p">(</span> <span class="n">granularity</span><span class="p">)</span>

	<span class="c">!write(*,*) &#39;Iteration after calibrate&#39;, iteration_count,&#39;proc&#39;,rank</span>

      <span class="n">count_loc</span><span class="p">%</span> <span class="n">val</span> <span class="o">=</span> <span class="n">iteration_count</span>
      <span class="n">count_loc</span><span class="p">%</span> <span class="nb">index</span> <span class="o">=</span> <span class="n">rank</span>

      <span class="n">globalminloc</span> <span class="o">=</span> <span class="n">count_loc</span>
      <span class="n">globalmaxloc</span> <span class="o">=</span> <span class="n">count_loc</span>

<span class="c">!  compute global counts before communicating them</span>

      <span class="k">sync all</span>

<span class="k">      do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
         <span class="k">if</span><span class="p">(</span> <span class="n">globalminloc</span><span class="p">[</span> <span class="n">i</span><span class="p">]%</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">globalminloc</span><span class="p">%</span> <span class="n">val</span> <span class="p">)</span><span class="k">then</span>
<span class="k">            </span><span class="n">globalminloc</span> <span class="o">=</span> <span class="n">globalminloc</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span>
         <span class="k">end if</span>
<span class="k">         if</span><span class="p">(</span> <span class="n">globalmaxloc</span><span class="p">[</span> <span class="n">i</span><span class="p">]%</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">globalmaxloc</span><span class="p">%</span> <span class="n">val</span> <span class="p">)</span><span class="k">then</span>
<span class="k">            </span><span class="n">globalmaxloc</span> <span class="o">=</span> <span class="n">globalmaxloc</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span>
         <span class="k">end if</span>
<span class="k">      end do</span>

<span class="k">      if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>
<span class="k">         write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;( a, i0/ a, i0, a, i0/ a, i0, a, i0)&#39;</span><span class="p">)</span> <span class="s2">&quot;my_count= &quot;</span><span class="p">,</span> <span class="n">iteration_count</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="s2">&quot;global_min= &quot;</span><span class="p">,</span> <span class="n">globalminloc</span><span class="p">%</span> <span class="n">val</span><span class="p">,</span> <span class="s2">&quot; min_loc= &quot;</span><span class="p">,</span> <span class="n">globalminloc</span><span class="p">%</span> <span class="nb">index</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="s2">&quot;global_max= &quot;</span><span class="p">,</span> <span class="n">globalmaxloc</span><span class="p">%</span> <span class="n">val</span><span class="p">,</span> <span class="s2">&quot; max_loc= &quot;</span><span class="p">,</span> <span class="n">globalmaxloc</span><span class="p">%</span> <span class="nb">index</span>
<span class="nb">         </span><span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s2">&quot;Using Global max for calibration&quot;</span>
      <span class="k">end if</span>

<span class="k">      </span><span class="n">iteration_count</span> <span class="o">=</span> <span class="n">globalmaxloc</span><span class="p">%</span> <span class="n">val</span>

   <span class="k">end if</span>

<span class="k">   </span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!  measurement loop</span>

   <span class="k">sync all</span>

<span class="k">   do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="n">w</span>
      <span class="n">r</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">loop</span><span class="p">(</span> <span class="n">iteration_count</span><span class="p">)</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">barrier</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<span class="k">         if</span><span class="p">(</span>  <span class="nb">mod</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">barrier</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">sync all</span>
<span class="k">      end if</span>
<span class="k">   end do</span>

<span class="k">   sync all</span>

<span class="c">! ----------------------------------------------------------------------</span>

<span class="c">!   build histograms</span>

   <span class="n">localsum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span> <span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="p">)</span> <span class="p">)</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      </span><span class="n">sum_all</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">localsum</span>

      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
         <span class="k">sync images</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span>
         <span class="n">sum_all</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">localsum</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span>
      <span class="k">end do</span>

<span class="k">   else</span>
<span class="k">      sync images</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span>
   <span class="k">end if</span>

<span class="k">   </span><span class="n">localmax</span> <span class="o">=</span> <span class="nb">maxval</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span> <span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="p">))</span>

   <span class="k">if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      </span><span class="n">globalmax</span> <span class="o">=</span> <span class="n">localmax</span>

      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
         <span class="k">sync images</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span>
         <span class="n">globalmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">globalmax</span><span class="p">,</span> <span class="n">localmax</span><span class="p">[</span> <span class="n">i</span><span class="p">])</span>
      <span class="k">end do</span>

<span class="k">   else</span>
<span class="k">      sync images</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span>
   <span class="k">end if</span>

<span class="k">   if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>
         <span class="n">globalmax</span><span class="p">[</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">globalmax</span>
      <span class="k">end do</span>

<span class="k">   end if</span>

<span class="k">   sync all</span>

<span class="k">   allocate</span><span class="p">(</span> <span class="n">localhist</span><span class="p">(</span> <span class="mi">0</span><span class="p">:</span> <span class="n">globalmax</span><span class="p">)[</span> <span class="o">*</span><span class="p">],</span> <span class="nb">stat</span><span class="o">=</span> <span class="n">astat</span> <span class="p">)</span>

   <span class="n">alloc_localhist_error</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">astat</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      stop</span> <span class="s1">&#39;error allocating localhist&#39;</span>

   <span class="k">end if </span><span class="n">alloc_localhist_error</span>

   <span class="n">localhist</span> <span class="o">=</span> <span class="mi">0</span>

   <span class="n">make_hist</span><span class="p">:</span> <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">w</span>

      <span class="n">localhist</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span> <span class="n">i</span><span class="p">))</span> <span class="o">=</span> <span class="n">localhist</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span> <span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>

   <span class="k">end do </span><span class="n">make_hist</span>

   <span class="n">final_print</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">then</span>

<span class="c">!  print rank 0&#39;s histogram</span>

      <span class="k">if</span><span class="p">(</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<span class="k">         write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;(a, i9, 9x, i9, 3x)&#39;</span><span class="p">)</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sum_all</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span><span class="c">!, trim( hostname)</span>
         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">globalmax</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">localhist</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<span class="k">               write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;(1x, i9, i9, i9, 3x)&#39;</span><span class="p">)</span> <span class="n">rank</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">localhist</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span><span class="c">!, trim( hostname)</span>
            <span class="k">end if</span>
<span class="k">         end do</span>

<span class="k">      end if</span>

<span class="c">!  print rank i&#39;s histogram</span>

      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span>

         <span class="k">sync images</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span>
         <span class="c">!localhist(:) = localhist(:)[ i]</span>
         <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="nb">lbound</span><span class="p">(</span><span class="n">localhist</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="nb">ubound</span><span class="p">(</span><span class="n">localhist</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
           <span class="n">localhist</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">localhist</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span> <span class="n">i</span><span class="p">]</span>
         <span class="k">end do</span>

         <span class="c">!hostname = hostname[ i]</span>
         <span class="k">if</span><span class="p">(</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<span class="k">            write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;(a, i9, 9x, i9, 3x)&#39;</span><span class="p">)</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sum_all</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span><span class="c">!, trim( hostname)</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">globalmax</span>
               <span class="k">if</span><span class="p">(</span> <span class="n">localhist</span><span class="p">(</span> <span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<span class="k">                  write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;(1x, i9, i9, i9, 3x)&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">localhist</span><span class="p">(</span> <span class="n">j</span><span class="p">)</span><span class="c">!, trim( hostname)</span>
               <span class="k">end if</span>
<span class="k">            end do</span>

<span class="k">         end if</span>
<span class="k">      end do</span>

<span class="k">   else </span><span class="n">final_print</span>

      <span class="k">sync images</span><span class="p">(</span> <span class="mi">1</span><span class="p">)</span>

   <span class="k">end if </span><span class="n">final_print</span>

<span class="k">stop</span> <span class="s1">&#39;normal exit in psnap&#39;</span>

<span class="k">contains</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">get_usecs</span><span class="p">()</span> <span class="k">result</span><span class="p">(</span> <span class="n">usecs</span><span class="p">)</span>
<span class="c">!integer( int64) :: usecs</span>

<span class="c">!  usec per sec</span>

<span class="c">!integer( int64), parameter :: c = 1000000</span>

<span class="c">!   integer( int64) :: t</span>

<span class="c">!   integer( int64) :: r</span>

<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span><span class="p">,</span><span class="n">r</span>
<span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">usecs</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="k">continue</span>

   <span class="c">!call system_clock( count= t, count_rate= r)</span>
   <span class="k">call </span><span class="nb">cpu_time</span><span class="p">(</span><span class="n">usecs</span><span class="p">)</span>
   <span class="n">usecs</span> <span class="o">=</span> <span class="n">usecs</span><span class="o">*</span><span class="mf">1.</span><span class="n">d6</span>
   <span class="c">!if( r /= c ) usecs = int( real( t, 8) / real( r, 8) * real( c, 8))</span>
   <span class="c">!if( r /= c ) usecs = int( t/r * c)</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">get_usecs</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">loop</span><span class="p">(</span> <span class="n">iterations</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span> <span class="n">dt</span><span class="p">)</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dt</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iterations</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>

   <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">usecs_init</span><span class="p">,</span> <span class="n">usecs_final</span>

   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">next_rank</span><span class="p">,</span> <span class="n">prev_rank</span>

   <span class="kt">integer</span><span class="p">,</span> <span class="k">codimension</span><span class="p">[</span> <span class="o">*</span><span class="p">],</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">coarray</span>

<span class="k">continue</span>

<span class="c">!   usecs_init = get_usecs()</span>

   <span class="k">call </span><span class="n">start_timer</span><span class="p">()</span>

   <span class="n">next_rank</span> <span class="o">=</span> <span class="n">to_upper_half</span><span class="p">(</span> <span class="n">rank</span><span class="p">)</span>
   <span class="n">prev_rank</span> <span class="o">=</span> <span class="n">from_lower_half</span><span class="p">(</span> <span class="n">rank</span><span class="p">)</span>

<span class="c">!   write(*,*) &#39;Proc&#39;,rank,&#39;Next rank&#39;,next_rank,&#39;Prev rank&#39;,prev_rank</span>

   <span class="n">counter</span><span class="p">:</span> <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iterations</span>

      <span class="n">even_odd</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">sending_half</span><span class="p">(</span> <span class="n">rank</span><span class="p">)</span> <span class="p">)</span><span class="k">then</span>

<span class="c">!  send rank to next then fetch rank</span>

         <span class="n">coarray</span><span class="p">[</span> <span class="n">next_rank</span><span class="p">]</span> <span class="o">=</span> <span class="n">coarray</span>

         <span class="k">sync images</span><span class="p">(</span> <span class="n">next_rank</span><span class="p">)</span>

      <span class="k">else </span><span class="n">even_odd</span>

<span class="c">!  stay calm</span>

         <span class="n">coarray</span><span class="p">[</span> <span class="n">prev_rank</span><span class="p">]</span> <span class="o">=</span> <span class="n">coarray</span>

         <span class="k">sync images</span><span class="p">(</span> <span class="n">prev_rank</span><span class="p">)</span>

      <span class="k">end if </span><span class="n">even_odd</span>

   <span class="k">end do </span><span class="n">counter</span>

<span class="c">!   usecs_final = get_usecs()</span>
   <span class="k">call </span><span class="n">stop_timer</span><span class="p">()</span>

<span class="c">!   write(*,*) &#39;usec_init&#39;,usec_init,&#39;usec_final&#39;,usec_final</span>

   <span class="n">dt</span> <span class="o">=</span> <span class="n">elapsed_time</span><span class="p">()</span>

   <span class="c">!write(*,*) &#39;usec_init&#39;,usec_init,&#39;usec_final&#39;,usec_final,&#39;dt&#39;,dt</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">loop</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">subroutine </span><span class="n">warmup_loop</span><span class="p">(</span> <span class="n">wa</span><span class="p">)</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wa</span>

<span class="c">!integer( int64), parameter :: counter = 1000000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">10000</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">min_time_usecs</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">loop_time</span>

   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>

<span class="k">continue</span>

<span class="k">   </span><span class="n">min_time_usecs</span> <span class="o">=</span> <span class="nb">huge</span><span class="p">(</span> <span class="mi">0_int64</span><span class="p">)</span>

   <span class="n">reloop</span><span class="p">:</span> <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">wa</span>

      <span class="n">loop_time</span> <span class="o">=</span> <span class="n">loop</span><span class="p">(</span> <span class="n">counter</span><span class="p">)</span>

      <span class="n">min_time_usecs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="n">loop_time</span><span class="p">,</span> <span class="n">min_time_usecs</span><span class="p">)</span>

   <span class="k">end do </span><span class="n">reloop</span>

<span class="k">return</span>

<span class="k">end subroutine </span><span class="n">warmup_loop</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">calibrate_loop</span><span class="p">(</span> <span class="n">usecs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span> <span class="n">cl</span><span class="p">)</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cl</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">usecs</span>

<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">calibrate_useconds</span> <span class="o">=</span> <span class="mi">100000000</span>
<span class="c">!real( real64), parameter :: preset_tolerance = 0.001_real64</span>
<span class="kt">real</span><span class="p">(</span> <span class="n">real64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">preset_tolerance</span> <span class="o">=</span> <span class="mf">1.0_real64</span>

<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">initial_ntrial</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c">!integer( int64), parameter :: initial_counter = 1000000</span>
<span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">initial_counter</span> <span class="o">=</span> <span class="mi">100000</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">counter</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">min_time_usecs</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tolerance</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">difference</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">total_time</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ntrial</span>
   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>

   <span class="kt">integer</span><span class="p">(</span> <span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">loop_time</span>

<span class="k">continue</span>

<span class="k">   </span><span class="n">counter</span> <span class="o">=</span> <span class="n">initial_counter</span>

   <span class="c">!write(*,*) &#39;Counter after initial counter&#39;,counter</span>

<span class="c">!  if usecs / granularity is less than 1/preset_tolerance then use zero</span>

   <span class="n">tolerance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="kt">real</span><span class="p">(</span> <span class="n">usecs</span><span class="p">,</span> <span class="n">real64</span><span class="p">)</span> <span class="o">*</span> <span class="n">preset_tolerance</span><span class="p">,</span> <span class="n">int64</span><span class="p">)</span>

   <span class="n">total_time</span> <span class="o">=</span> <span class="mi">0</span>

   <span class="n">trials</span><span class="p">:</span> <span class="k">do</span>

<span class="k">      </span><span class="n">ntrial</span> <span class="o">=</span> <span class="n">initial_ntrial</span>
      <span class="n">min_time_usecs</span> <span class="o">=</span> <span class="nb">huge</span><span class="p">(</span> <span class="mi">0_int64</span><span class="p">)</span>

      <span class="n">get_min</span><span class="p">:</span> <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ntrial</span>

         <span class="n">loop_time</span> <span class="o">=</span> <span class="n">loop</span><span class="p">(</span> <span class="n">counter</span><span class="p">)</span>
	 <span class="c">!write(*,*) &#39;loop_time&#39;,loop_time</span>
         <span class="n">min_time_usecs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="n">min_time_usecs</span><span class="p">,</span> <span class="n">loop_time</span><span class="p">)</span>

      <span class="k">end do </span><span class="n">get_min</span>

<span class="c">!  keep an estimate of total calibration time</span>

      <span class="n">total_time</span> <span class="o">=</span> <span class="n">total_time</span> <span class="o">+</span> <span class="n">min_time_usecs</span> <span class="o">*</span> <span class="n">ntrial</span>

      <span class="n">counter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="kt">real</span><span class="p">(</span> <span class="n">counter</span><span class="p">,</span> <span class="n">real64</span><span class="p">)</span> <span class="o">*</span> <span class="kt">real</span><span class="p">(</span> <span class="n">usecs</span><span class="p">,</span> <span class="n">real64</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span> <span class="n">min_time_usecs</span><span class="p">,</span> <span class="n">real64</span><span class="p">),</span> <span class="n">int64</span><span class="p">)</span>

      <span class="c">!write(*,*) &#39;Counter after assignment&#39;,counter</span>

      <span class="n">difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">min_time_usecs</span> <span class="o">-</span> <span class="n">usecs</span><span class="p">)</span>

      <span class="k">if</span><span class="p">(</span> <span class="n">difference</span> <span class="o">&lt;=</span> <span class="n">tolerance</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">total_time</span> <span class="o">&gt;=</span> <span class="n">calibrate_useconds</span> <span class="p">)</span> <span class="k">exit </span><span class="n">trials</span>

   <span class="k">end do </span><span class="n">trials</span>

   <span class="n">cl</span> <span class="o">=</span> <span class="n">counter</span>

   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;( a, i2, a, i10, a, i10, a, i10, a, i10)&#39;</span> <span class="p">)</span> <span class="s2">&quot;#rank= &quot;</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="p">&amp;</span>
                                                                           <span class="s2">&quot; count= &quot;</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="s2">&quot; time= &quot;</span><span class="p">,</span> <span class="n">min_time_usecs</span><span class="p">,</span> <span class="p">&amp;</span>
                                                                           <span class="s2">&quot; difference= &quot;</span><span class="p">,</span> <span class="n">difference</span><span class="p">,</span> <span class="s2">&quot; tolerance= &quot;</span><span class="p">,</span> <span class="n">tolerance</span>

   <span class="n">time_out</span><span class="p">:</span> <span class="k">if</span><span class="p">(</span> <span class="n">total_time</span> <span class="o">&gt;</span> <span class="n">calibrate_useconds</span> <span class="p">)</span><span class="k">then</span>

<span class="k">      write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="s1">&#39;( a, i2, a, f10.4, a, f10.4, a, f10.4, a, i0)&#39;</span> <span class="p">)</span> <span class="s2">&quot;PSNAP: WARNING rank &quot;</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="p">&amp;</span>
                                                                  <span class="s2">&quot; didn&#39;t converge in 10 seconds tolerance = &quot;</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                                  <span class="kt">real</span><span class="p">(</span> <span class="n">difference</span><span class="p">)</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span> <span class="n">usecs</span><span class="p">),</span> <span class="p">&amp;</span>
                                                                  <span class="s2">&quot; should be &quot;</span><span class="p">,</span> <span class="n">preset_tolerance</span><span class="p">,</span> <span class="s2">&quot; approx &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                                  <span class="n">preset_tolerance</span> <span class="o">*</span> <span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot; percent, granularity= &quot;</span><span class="p">,</span> <span class="n">usecs</span>

   <span class="k">end if </span><span class="n">time_out</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">calibrate_loop</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">subroutine </span><span class="n">print_banner</span><span class="p">()</span>

<span class="k">continue</span>

<span class="k">   write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;########&#39;</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;##P-SNAP: PAL System Noise Activity Program&#39;</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;##&#39;</span> <span class="o">//</span> <span class="n">psnap_rcs_id</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;##This is a Fortran translation of P-SNAP v 1.2 from&#39;</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;##http://www.c3.lanl.gov/pal/software/psnap/&#39;</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;##This program is the coarray ping-pong version&#39;</span>
   <span class="k">write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">output_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="s1">&#39;########&#39;</span>

<span class="k">return</span>

<span class="k">end subroutine </span><span class="n">print_banner</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">subroutine </span><span class="n">usage</span><span class="p">()</span>

<span class="kt">character</span><span class="p">(</span> <span class="nb">len</span><span class="o">=</span> <span class="o">*</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span> <span class="mi">17</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">msg</span> <span class="o">=</span> <span class="p">&amp;</span>
 <span class="p">[</span> <span class="s2">&quot;Usage: psnap [OPTIONS]                                             &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                                                                   &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -n &lt;reps&gt;   number of repetitions                                &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                default: 100000                                    &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -w &lt;reps&gt;   number of warm-up repetitions                        &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                default: 10%% of the number of reps                &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -c &lt;count&gt;  calibration count                                    &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                default: perform a calibration to match granularity&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -g &lt;usecs&gt;  granularity of the test in microseconds              &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                default: 1000                                      &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -b &lt;N&gt;      perform a barrier between every N loops              &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                default: no                                        &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  -h          this message                                         &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                                                                   &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;  Example: psnap -n 1000000 -w 10 &gt; psnap.out                      &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;    runs a test with 1000000 repetitions and 10 warm-up reps.      &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="s2">&quot;                                                                   &quot;</span> <span class="p">]</span>

   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>

<span class="k">continue</span>

<span class="k">   write</span><span class="p">(</span> <span class="n">unit</span><span class="o">=</span> <span class="n">error_unit</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span> <span class="n">string_fmt</span><span class="p">)</span> <span class="p">(</span> <span class="nb">trim</span><span class="p">(</span> <span class="n">msg</span><span class="p">(</span> <span class="n">i</span><span class="p">)),</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span> <span class="n">msg</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">stop</span> <span class="s1">&#39;normal exit in usage&#39;</span>

<span class="k">end subroutine </span><span class="n">usage</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">sending_half</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span> <span class="n">l</span><span class="p">)</span>

<span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<span class="kt">logical</span> <span class="kd">::</span> <span class="n">l</span>

<span class="k">continue</span>

<span class="c">!  this must process np == even values only</span>

   <span class="n">l</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">np_half</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">sending_half</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">to_upper_half</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span> <span class="n">l</span><span class="p">)</span>

<span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<span class="kt">integer</span> <span class="kd">::</span> <span class="n">l</span>

<span class="k">continue</span>

<span class="c">!  this must process lower half ranks only</span>

   <span class="n">l</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">np_half</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">to_upper_half</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">function </span><span class="n">from_lower_half</span><span class="p">(</span> <span class="n">i</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span> <span class="n">l</span><span class="p">)</span>

<span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span> <span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<span class="kt">integer</span> <span class="kd">::</span> <span class="n">l</span>

<span class="k">continue</span>

<span class="c">!  this must process upper half ranks only</span>

   <span class="n">l</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">np_half</span>

<span class="k">return</span>

<span class="k">end function </span><span class="n">from_lower_half</span>

<span class="c">! ---------------------------------------------------------------------</span>

<span class="k">end program </span><span class="n">psnap</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

    <hr>
    <footer>
      <div class="row">
        <div class="col-md-4">&copy; 2016 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></div>
        <div class="col-md-4"><span class="text-center"> OpenCoarrays was developed by Sourcery Institute</span></div>
        <div class="col-md-4">
          <span class="pull-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </span>
        </div>
      </div>
      <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>